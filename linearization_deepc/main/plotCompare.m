%%%%%%%%%%%%%%%%%%%%%%%%%%%% Nice ones %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % trubulent wind, N = 500, p = 50, f = 20 - genSpeed
% file1 = 'outputData\turbWind_noPreview_QP_tuningN1.mat';
% file2 = 'outputData\turbWind_preview_QP_tuningp5.mat';

% % eog, N = 500, p = 50, f = 20 - genSpeed
% file1 = 'outputData\eogWind_noPreview_QP.mat';
% file2 = 'outputData\eogWind_preview_QP.mat';

% % turbulent wind, N = 500, p = 40, f = 20, rotSpeed
file1 = 'outputData\turbWindRot_noPreview_QP_tuningp.mat';
file2 = 'outputData\turbWindRot_preview_QP_tuningp2.mat';

% % eog wind, N = 500, p = 40, f = 20, rotSpeed
% file1 = 'outputData\eogWindRot_noPreview_QP.mat';
% file2 = 'outputData\eogWindRot_preview_QP_tuningQ.mat';

% % Fsg Mp preview, N = 600, p = f = 20, Q = 1, genSpeed
% file1='outputData\wave_noPreview_QP_tuningN.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_tuningN3.mat';

% Fsg Mp preview scaled N = 400, p = 40, f = 20, Q = 100, genspeed 
% file1='outputData\wave_noPreview_QP_scaled2.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled2.mat';

% Fsg Mp preview scaled N = 600, p = 40, f = 20, Q = 100, genspeed 
% file1='outputData\wave_noPreview_QP_scaled2.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled2.mat';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% file1='outputData\wave_noPreview_QP_scaled.mat';
% file1='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf1.mat';
% file3='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf2.mat';
% file4='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf3.mat';
% file5='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf4.mat';
% file6='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf5.mat';

% file1='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningf.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningp.mat';
% file3='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningp1.mat';
% file4='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningp2.mat';
% file5='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningp3.mat';

% file1='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningQ.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningQ1.mat';
% file3='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningQ2.mat';
% file4='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningQ3.mat';
% file5='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningQ4.mat';
% 
% file1='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningN.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningN1.mat';
% file3='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningN2.mat';
% file4='outputData\wave_Fsg_Mp_preview_QP_scaled_tuningN3.mat';
% % 
% file1='outputData\wave_Fsg_Mp_preview_QP_tuningN3.mat';
% file2='outputData\wave_Fsg_Mp_preview_QP_scaled2.mat';


% file1='outputData\wave_noPreview_QP_scaled1.mat';
% file2='outputData\wave_noPreview_QP_scaled2.mat';
% file3='outputData\wave_noPreview_QP_scaled3.mat';
% file4='outputData\wave_noPreview_QP_scaled4.mat';

% file1='controlActionComp\wave_noPreview_QP_scaled.mat';
% file2='controlActionComp\wave_Fsg_Mp_preview_QP_scaled.mat';

% file1='outputData\wave_Fsg_Mp_preview_QP_tuningN3.mat';
% file1='controlActionComp\wave_Fsg_Mp_preview_QP_scaled.mat';

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% file1 ='invFF\waveRotSpeed_invFF_QP_scaled.mat';
% file2='invFF\waveRotSpeed_noPreview_QP_scaled.mat';
% file3='invFF\waveRotSpeed_Fsg_Mp_preview_QP_scaled.mat';
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% file1 ='invFF\waveRotSpeed_invFF_QP.mat';
% file2='invFF\waveRotSpeed_noPreview_QP.mat';
% file3='invFF\waveRotSpeed_Fsg_Mp_preview_QP.mat';
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% file1='invFF\waveRotSpeed_invFF_QP.mat';
% file2='invFF\waveRotSpeed_invFF_QP_scaled.mat';

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Decrease/increase f window for wave preview
% file1='invFF\waveRotSpeed_Fsg_Mp_preview_QP1.mat';
% file2='invFF\waveRotSpeed_Fsg_Mp_preview_QP2.mat';
% file3='invFF\waveRotSpeed_Fsg_Mp_preview_QP3.mat';
% file4='invFF\waveRotSpeed_Fsg_Mp_preview_QP5.mat';
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% file1='invFF\waveRotSpeed_noPreview_QP1.mat';
% file2='invFF\waveRotSpeed_Fsg_Mp_preview_QP3.mat';

% file1='outputData\waveRotSpeed_noPreview_QP_scaled6.mat';
% file2='outputData\waveRotSpeed_Mp_preview_QP_scaled6.mat';


% file1='outputData\aa_noPreview_QP4.mat';
% file2='outputData\aa_noPreview_QP4.mat';

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % Wind in OL, TurbWind in CL, both wind and waves in preview
% file1='outputData\waveRotSpeed_noPreview_QP_scaled9.mat';
% file2='outputData\waveRotSpeed_Fsg_Mp_preview_QP_scaled.mat';
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % Wind in OL, EOG in CL, both wind and waves in preview
% file1='outputData\waveRotSpeed_noPreview_QP_scaled10.mat';
% file2='outputData\waveRotSpeed_Fsg_Mp_preview_QP_scaled1.mat';
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% file1='outputData\eogWindRot_noPreview_QP2.mat';
% file2='outputData\eogWindRot_preview_QP2.mat';

%%%%%%%masterMeeting%%%%%%%%%
% file1='masterMeeting\eog_noPreview_QP.mat';
% file2='masterMeeting\eog_preview_QP.mat';

% file1='masterMeeting\turb_noPreview_QP.mat';
% file2='masterMeeting\turb_preview_QP.mat';
% 
% file1='masterMeeting\wave_noPreview_QP_scaled1.mat';
% file2='masterMeeting\wave_Mp_preview_QP_scaled1.mat';

% Turbwind added on wave preview
file1='masterMeeting\wave_Mp_preview_QP_scaled1.mat';
file2='masterMeeting\wave_Mp_preview_QP_scaled3.mat';

% 2xdeepc vs deepc2xd
file1='masterMeeting\wave_Mp_preview_QP_scaled1.mat';
file2='masterMeeting\wave_Mp_preview_QP_scaled3.mat';

% file1='masterMeeting\wave2x_noPreview_QP_scaled.mat';
% file2='masterMeeting\wave2x_Fsg_Mp_preview_QP_scaled.mat';

% file1='updateMeeting\sim1_Fsg_preview_QP_scaled.mat'
% file2='updateMeeting\sim2_Fsg_preview_QP_scaled.mat'
% file3='updateMeeting\sim3_Fsg_preview_QP_scaled.mat'
% file4='updateMeeting\sim4_Fsg_preview_QP_scaled.mat'
% 
% file1='updateMeeting\wave_noPreview_QP_scaled.mat';
% file1='updateMeeting\wave_Mp_preview_QP_scaled.mat';
% file2='updateMeeting\wave_wWind_Mp_preview_QP_scaled.mat';
% 
% 
% file1='updateMeeting\wave_wind_noPreview_QP_scaled.mat';
% file2='updateMeeting\wave_wWind_Mp_preview_QP_scaled.mat';
% file3='updateMeeting\wave_wWind_Fsg_Mp_preview_QP_scaled.mat';

%%%%%%%%%%%%%%%% Update meeting 24.11 %%%%%%%%%%%%%%%%%%%%%%%%%
file1 = 'updateMeeting2\wave_ptfmPitch_unbounded_noPreview_QP_scaled.mat';
file2 = 'updateMeeting2\wave_ptfmPitch_unbounded_Mp_preview_QP_scaled.mat';
file3 = 'updateMeeting2\wave_ptfmPitch_bounded_noPreview_QP_scaled.mat';
file4 = 'updateMeeting2\wave_ptfmPitch_bounded_Mp_preview_QP_scaled.mat';

file1 = 'updateMeeting2\wave_ptfmPitch_unbounded_noPreview_QP_scaled.mat';
file2 = 'updateMeeting2\wave_ptfmPitch_bounded_noPreview_QP_scaled.mat';
file3 = 'updateMeeting2\wave_ptfmPitch_bounded_Mp_preview_QP_scaled.mat';

% file1 = 'updateMeeting2\wave_ptfmPitch_bounded_noPreview_QP_scaled1.mat';
% file2 = 'updateMeeting2\wave_ptfmPitch_bounded_Mp_preview_QP_scaled1.mat';
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

file1='updateMeeting2\wave_ptfmPitch_unbounded_noPreview_QP_scaled.mat';
file2='updateMeeting2\wave_ptfmPitch_unbounded_Mp_preview_QP_scaled1.mat';

file1 = 'updateMeeting3\wave_ptfmPitch_unbounded_noPreview_QP_scaled2.mat';
% file2='updateMeeting3\wave_ptfmPitch_bounded_noPreview_QP_scaled1.mat';
file3='updateMeeting3\wave_ptfmPitch_bounded_Mp_preview_QP_scaled1.mat';

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% final tsts
file1=('finalTests\tg_Mp_preview_QP_scaled.mat')
file2=('finalTests\tg_Mp_preview_QP_scaled1.mat')

% file0 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar1.mat';
% file1 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar2.mat';
% file2 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar3.mat';
% file3 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar4.mat';
% file4 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar5.mat';
% file5 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar6.mat';
% file6 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar7.mat';
% file7 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar8.mat';
% file8 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar9.mat';
% file9 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar10.mat';
% file10 = 'noiseVar\steadyWind_irrWaves_Hs3Tp12_noiseVar_Mp_preview_QP_scaled_tuningvar11.mat';

% file10,file7,file3,file1

file0 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar.mat';
file1 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar1.mat';
file2 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar2.mat';
file3 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar3.mat';
file4 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar4.mat';
file5 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar5.mat';
file6 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar6.mat';
file7 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar7.mat';
file8 = 'previewBias\steadyWind_irrWaves_Hs3Tp12_previewNoise_Mp_preview_QP_scaled_tuningvar8.mat';

% % % Update data structure for old data files
% inName = '\theta_c (in deg)';
% outName = 'Generator speed (in rpm)';
% scaledFlag = 0;
% controlParams.lbu = -10;
% controlParams.ubu = 10;
% controlParams.duDeg = 8;
% controlParams.Q = Q;
% description = '';
% save(file1,'inName','outName','scaledFlag','controlParams','description', ...
% "-append")
% save(file2,'kFinal',"-append")

% plotComp(file1,file2)%,file3)%,file4)%,file5)%,file6)%,file7)
% plotComp(file1,file2,file3,file4,file5)%,file6)%,file7)
% plotComp(file1,file2,file3,file4)%,file5)%,file6)%,file7)
% plotComp(file0,file1,file2,file3,file4,file5,file6,file7,file8)%,file7,file8,file9,file10)
plotComp(file8,file7,file6,file5,file4,file3,file2,file1,file0)%,file7,file8,file9,file10)
% plotComp(file10,file6,file3,file1)
% Required fields in data files: 
% inName: name and measurement unit of control input
% outName: name and measurement unit of controlled output
% tsim: simulation time vector
% ref: reference vector
% Ts: sampling period
% controlParams: p,f,Q,R,N
% out: controlled output sequence
% uSeq: control input sequence
% descriprion: short description mentioning preview content if preview is
%              enabled
% scaledFlag: flag indicating whether the system was scaled or not
% uhat_max, ehat_max: only necessary if scaledFlag == 1, indicate scaling
%                     values for signal reconstruction to real life values

function [] = plotComp(varargin)
% plotComp(varargin) Function used to compare control output, control 
% input and control input rate of an arbitrary number of simulations.
%
% Input arguments:
%-----------------
% varargin : file names containing data to be compared. If the type of
% comparison is No preview VS Preview or Not scaled VS Scaled, the files
% must be provided in this order.
%
% Output arguments:
%------------------
% -
%==========================================================================

nFiles = length(varargin);
if nFiles == 0
    error('No files provided.')
end

data = cell(nFiles,1);
for idxFile = 1:nFiles
    data{idxFile} = load(varargin{idxFile});
end

kFinal = data{1}.kFinal;
Ts = data{1}.Ts;
f = data{1}.controlParams.f;
legendStr = cell(nFiles,1);
RMSE = zeros(nFiles,1);
colorVec = {'k','r','b','g','m','y','#33A0C3','#904FF2','#EB018F','#34EBCC'};

contentAns = input(['Plot comparison type:\n1 - No preview VS Preview\n' ...
    '2 - Different preview components\n' ...
    '3 - Tuning\n' ...
    '4 - Not scaled VS Scaled: ']);
if contentAns == 3
    tunedVar = input('Which variable? Q/ R/ p/ f/ N: ','s');
end

% Build legend
for idxOut = 1:nFiles
    switch contentAns
        case 2
            legendStr{idxOut} = data{idxOut}.description;
        case 3 
            switch tunedVar
                case {'Q','R'}
                    legendStr{idxOut} = [tunedVar '=' num2str(eval(['data{' num2str(idxOut) '}.controlParams.' tunedVar '(1,1)']))];
                otherwise
                    legendStr{idxOut} = [tunedVar '=' num2str(eval(['data{' num2str(idxOut) '}.controlParams.' tunedVar]))];                    
            end
    end
end

for idxOut = 1:nFiles
    stds(idxOut) = data{idxOut}.controlParams.previewNoiseStd;
    norms(idxOut) = data{idxOut}.info.normE;
end

figure
semilogx(stds.^2, norms,'k','LineWidth',1)
hold on
ylabel('||\omega_{err}||_2')
xlabel('var(d_k)')
grid on
set(gcf,'Color','White')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Output plot %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
nOutputs = size(data{idxOut}.out,1);
for idxNumOutput = 1:2
    figure
    for idxOut = 1:nFiles
        % Reconstruct data if it was scaled
        if data{idxOut}.scaledFlag == 1
            data{idxOut}.ehat_max = diag(data{idxOut}.Dy);
            data{idxOut}.out(idxNumOutput,:) = data{idxOut}.out(idxNumOutput,:).*data{idxOut}.ehat_max(idxNumOutput);
        end
        plot(data{idxOut}.tsim, 12.1+data{idxOut}.out(idxNumOutput,:),'LineWidth',1,Color=colorVec{idxOut});
        disp(legendStr{idxOut});rmse(data{idxOut}.out(idxNumOutput,20:end), zeros(length(data{idxOut}.out(idxNumOutput,20:end)),1)')
        hold on
    end
    xlabel('Time (in s)')
    ylabel(data{1}.outName(idxNumOutput))
    title('DeePC for reference tracking')
    grid on
    hold on
    % plot(data{1}.tsim,data{1}.ref(idxNumOutput:nOutputs:end)+12.1) % reference
    % xline(Ts*f,'k--','Future window size')
    if data{idxOut}.scaledFlag == 1
        yline(data{idxOut}.controlParams.lby(idxNumOutput)*data{idxOut}.ehat_max(idxNumOutput)+12.1,'r--','LineWidth',1)
        yline(data{idxOut}.controlParams.uby(idxNumOutput)*data{idxOut}.ehat_max(idxNumOutput)+12.1,'r--','LineWidth',1)
    else
        yline(data{idxOut}.controlParams.lby(idxNumOutput),'r--','LineWidth',1)
        yline(data{idxOut}.controlParams.uby(idxNumOutput),'r--','LineWidth',1)
    end
    % stepIdxs = find(data{1}.ref);
    % xline(Ts*stepIdxs(1),'k--','Reference step')
    switch contentAns
        case 1
            legend('No preview','With preview','Location','SouthEast')
        case {2,3}
            legend(legendStr,'Location','SouthEast')
        case 4
            legend('Not scaled','Scaled','Location','SouthEast')
    end
    set(gcf,'Color','White')
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% disp(RMSE);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Input plot %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
figure
for idxOut = 1:nFiles
    % Reconstruct data if it was scaled
    if data{idxOut}.scaledFlag == 1
        data{idxOut}.uhat_max = diag(data{idxOut}.Du);
        plot(data{idxOut}.tsim,rad2deg(data{idxOut}.uSeq.*data{idxOut}.uhat_max),'LineWidth',1,Color=colorVec{idxOut});
    else
        plot(data{idxOut}.tsim,rad2deg(data{idxOut}.uSeq),'LineWidth',1,Color=colorVec{idxOut}); 
    end
    hold on
end
xlabel('Time (in s)')
ylabel(data{1}.inName)
ylim([-15 15])
if data{idxOut}.scaledFlag == 1
    yline(rad2deg(data{1}.controlParams.lbu*data{idxOut}.uhat_max),'r--','LineWidth',1)
    yline(rad2deg(data{1}.controlParams.ubu*data{idxOut}.uhat_max),'r--','LineWidth',1)
else
    yline(rad2deg(data{1}.controlParams.lbu),'r--','LineWidth',1)
    yline(rad2deg(data{1}.controlParams.ubu),'r--','LineWidth',1)
end
xline(Ts*f,'k--','Future window size')
% stepIdxs = find(data{1}.ref);
% xline(Ts*stepIdxs(1),'k--','Reference step')
title('Control input')
switch contentAns
    case 1
        legend('No preview','With preview','Location','SouthEast')
    case {2,3}
        legend(legendStr,'Location','SouthEast')
    case 4
        legend('Not scaled','Scaled','Location','SouthEast')
end
grid on
set(gcf,'Color','White')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%% Control input rate %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
figure
for idxOut = 1:nFiles
    % Reconstruct data if it was scaled
    if data{idxOut}.scaledFlag == 1
        plot(data{idxOut}.tsim(1:end-1),rad2deg(diff(data{idxOut}.uSeq)*(1/Ts).*data{idxOut}.uhat_max),'LineWidth',1,Color=colorVec{idxOut}); 
    else
        plot(data{idxOut}.tsim(1:end-1),diff(rad2deg(data{idxOut}.uSeq))*(1/Ts),'LineWidth',1,Color=colorVec{idxOut}); 
    end
    hold on
end
xlabel('Time (in s)')
ylabel('\theta_c rate (in deg/s)')
if data{idxOut}.scaledFlag == 1
    yline(rad2deg(data{1}.controlParams.duf*data{idxOut}.uhat_max/Ts),'r--','LineWidth',1)
    yline(-rad2deg(data{1}.controlParams.duf*data{idxOut}.uhat_max/Ts),'r--','LineWidth',1)
else
    yline(rad2deg(data{1}.controlParams.duf/Ts),'r--','LineWidth',1)
    yline(-rad2deg(data{1}.controlParams.duf/Ts),'r--','LineWidth',1)
end
xline(Ts*f,'k--','Future window size')
ylim([-15 15])
title('Control input rate')
switch contentAns
    case 1
        legend('No preview','With preview','Location','SouthEast')
    case {2,3}
        legend(legendStr,'Location','SouthEast')
    case 4
        legend('Not scaled','Scaled','Location','SouthEast')
end
grid on
set(gcf,'Color','White')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


end

